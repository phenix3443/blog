---
title: Elliptic Curve
description: 椭圆曲线加密算法
slug: elliptic_curve
date: 2023-09-06T10:21:15+08:00
featured: false
draft: false
comment: true
toc: true
reward: true
pinned: false
carousel: false
math: true
series: 
  - 以太坊中的密码学
categories:
  - ethereum
tags:
  - zkevm
  - zkp
  - commitments
  - cryptography
---

本文介绍椭圆曲线加密算法。

<!--more-->

## 椭圆曲线

## 基本性质

## 加法

## 双线性配对{#pairing}

椭圆曲线配对（Elliptic Curve Pairing）是密码学中的一个重要概念，它将两个椭圆曲线上的点进行映射，得到一个标量值。

具体来说，给定两个椭圆曲线 $G_1$ 和 $G_2$，以及各自的生成元 $P_1$ 和 $P_2$，椭圆曲线配对可以定义为一个映射

$$
e: G_1 × G_2 → G_T
$$

其中 $G_T$ 是一个多项式群。这个映射满足一些特定的性质：

$$
e(P + P', Q) = e(P, Q) · e(P', Q)\\\\
e(P, Q + Q') = e(P, Q) · e(P, Q')
$$

推导出：

1. $e(m \ast P_1, n \ast P_2) = e(P_1, P_2)^{m \ast n}$

同时 e 必须是 [非退化的]({{< ref "#non_degeneracy" >}})（non_degeneracy）:

可用于破解 DDH 问题，以及用于现代加密体系如 ZkSNARK. 简单来说，基于 pairing 的加密体系能够通过密文验证两组明文的乘积是否相同，但仍然不会暴露这个乘积。这是有趣的一点，因为传统加密体系要求算法尽可能多的破坏明文的信息，但 pairing 却可以通过密文来获得部分关于明文的知识。

进一步扩展请阅读 [vitalik: 探索椭圆曲线配对]({{< ref "../exploring-elliptic-curve-pairings" >}})

### 双线性映射{#bilinear_mapping}

椭圆曲线配对（Elliptic Curve Pairing）和 [双线性映射（Bilinear Mapping）]({{< ref "../cryptography#bilinear_mapping" >}}) 之间存在密切的关系，因为椭圆曲线配对通常是一种实现双线性映射的特殊数学运算。让我们更详细地解释它们之间的关系：

- 双线性映射： 双线性映射是一个数学映射，它将两个群（通常是椭圆曲线上的群）的元素映射到另一个群中的元素。这种映射满足双线性性质，也就是说，它同时保持了两个群的乘法运算的线性性质。

- 椭圆曲线配对： 椭圆曲线配对是一种特殊的双线性映射，它通常应用于椭圆曲线上的点集。具体来说，椭圆曲线配对操作将两个椭圆曲线上的点映射到一个特殊的数学群中的元素，并且满足双线性性质。

关系： 椭圆曲线配对是一种双线性映射的实例，其中两个输入群和一个输出群都是椭圆曲线上的点集。这种特殊的双线性映射在密码学中非常有用，因为它允许在椭圆曲线上的点之间执行复杂的数学运算，同时保持线性性质，这对于密码学协议的安全性和隐私保护至关重要。

应用： 椭圆曲线配对的双线性性质在密码学领域中有广泛的应用，包括零知识证明、身份认证、可验证随机函数（VRF）、隐私保护计算等。这些协议通常利用椭圆曲线上的点与其配对操作之间的关系，以实现安全的通信和计算。

总之，椭圆曲线配对是双线性映射的一种特殊实现，它在密码学中发挥着重要的作用，允许在椭圆曲线上的点之间执行双线性运算，同时保持了线性性质。这种性质使得它在实现安全的密码学协议和隐私保护计算中非常有用。

### 非退化性{#non_degeneracy}

在椭圆曲线配对（Elliptic Curve Pairing）中，"非退化性" 是一个重要的性质，指的是椭圆曲线上的特定配对操作不会在某些情况下返回无限远点（曲线上的零元素）。这个性质对于密码学协议的安全性非常重要。

具体来说，椭圆曲线配对中的非退化性通常体现在以下两个方面：

- 不同的点不会产生无限远点： 对于椭圆曲线上的不同点 P 和 Q，进行配对操作 e(P, Q) 不会返回无限远点。也就是说，如果 P ≠ Q，则 e(P, Q) ≠ ∞，其中 ∞ 表示曲线上的无限远点。

- 一对点不会使配对结果为无限远点： 对于椭圆曲线上的一对点 P 和 Q，进行配对操作 e(P, Q) 不会返回无限远点。也就是说，如果 P 和 Q 是有效的曲线点，e(P, Q) ≠ ∞。

这个非退化性性质对于椭圆曲线密码学中的协议非常关键，因为它确保了配对操作的可逆性和安全性。如果配对操作可能返回无限远点，那么在密码学协议中可能会引入漏洞，导致信息泄漏或不正确的计算结果。

因此，在设计和使用椭圆曲线配对的密码学协议中，通常会要求所选择的椭圆曲线和配对操作满足非退化性的性质，以确保协议的安全性和正确性。非退化性是椭圆曲线配对的一个重要属性，它为密码学领域提供了强大的工具，用于隐私保护、安全计算和其他应用。

## 嵌入度{#embedding_degree}

椭圆曲线的嵌入度（Embedding Degree）是一个与椭圆曲线密码学中的数学参数相关的概念。它表示一个椭圆曲线上的点如何映射到有限域中的元素，并影响到密码学协议的性能和安全性。以下是对椭圆曲线嵌入度的解释：

有限域和椭圆曲线： 在椭圆曲线密码学中，通常会使用有限域（Finite Field）上的椭圆曲线。有限域是一个包含有限元素的数学结构，椭圆曲线则是定义在这个有限域上的一组点的集合。

椭圆曲线上的点映射到有限域： 椭圆曲线上的点（通常表示为 (x, y) 坐标）需要映射到有限域中的元素。这个映射过程将一个椭圆曲线上的点映射为有限域中的整数。

嵌入度的定义： 嵌入度表示了椭圆曲线上的点在映射到有限域中时的“放大倍数”。具体来说，如果椭圆曲线的嵌入度为 k，那么椭圆曲线上的一个点在映射到有限域中时，其坐标值需要乘以 k 才能表示为有限域中的整数。

影响： 嵌入度对密码学协议的性能和安全性有一定的影响。较小的嵌入度可能会导致更高效的计算，但也可能降低协议的安全性。较大的嵌入度通常提供更强的安全性，但可能需要更复杂的计算。因此，在设计和选择椭圆曲线时，需要权衡这些因素，以满足协议的需求。

总之，椭圆曲线的嵌入度是描述椭圆曲线上的点如何映射到有限域中的整数的概念。它对密码学协议的性能和安全性有重要影响，需要根据具体的应用需求进行选择和权衡。

## Tate 配对{#tate_pairing}

Tate 配对（Tate Pairing）是椭圆曲线密码学中一种重要的数学工具，用于在两个椭圆曲线上计算离散对数问题的解，或者用于构建密码学协议，如身份验证和数字签名。Tate 配对是由约翰·图尔（John Tate）提出的，它利用了椭圆曲线上的双线性映射的性质

要理解 Tate 配对，首先需要了解以下基本概念：

椭圆曲线： 椭圆曲线是一种代数结构，通常表示为 $y^2 = x^3 + ax + b$，其中 $a$ 和 $b$ 是曲线的参数。它包括一组点，满足曲线方程，形成一个群结构，可以进行点的加法和乘法运算。

双线性映射： 双线性映射是一种映射函数，它满足一些特定的性质。对于两个椭圆曲线上的点，Tate 配对利用了双线性映射的性质，使得它能够将两个点映射到一个有限域中的元素。

离散对数问题： 在椭圆曲线密码学中，离散对数问题是一个基本的难题。给定点 $P$ 和 $Q$，找到一个整数 $n$，使得 $nP = Q$，其中 $n$ 就是离散对数。Tate 配对可以用于解决这个问题。

Tate 配对的主要思想是利用双线性映射来将两个椭圆曲线上的点映射到一个有限域中的元素，并通过计算这个映射值来实现离散对数问题的解。Tate 配对的具体计算过程相当复杂，涉及大量的数学运算，包括指数运算和模运算。但总的来说，它为椭圆曲线密码学提供了一种强大的工具，用于实现安全的加密和数字签名算法。

需要注意的是，Tate 配对不仅可以用于解决离散对数问题，还可以用于设计具有高度安全性的密码学协议，例如身份验证方案和属性基础加密（Attribute-Based Encryption，ABE）等。它是椭圆曲线密码学领域中的一个重要数学工具，对于构建安全的密码学系统起着关键作用。

## 延伸阅读

- [椭圆曲线密码学简介（一）：实数域的椭圆曲线及其群运算规则](https://zhuanlan.zhihu.com/p/102807398)
- [椭圆曲线密码学简介（二）：有限域的椭圆曲线及离散对数问题](https://zhuanlan.zhihu.com/p/104531745)
- [椭圆曲线密码学简介（三）：ECDH 加密算法和 ECDSA 数字签名算法](https://zhuanlan.zhihu.com/p/107599962)
- [椭圆曲线密码学简介（四）：破解安全性及与 RSA 之间的比较](https://zhuanlan.zhihu.com/p/108103413)
- [一文读懂 ECDSA 算法如何保护数据](https://zhuanlan.zhihu.com/p/97953640)
- [椭圆曲线密码学的简单介绍](https://zhuanlan.zhihu.com/p/26029199)
